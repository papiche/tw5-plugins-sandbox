!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).spotlight={})}(this,function(e){"use strict";function t(e,t){o(e,t,!0)}function n(e,t){o(e,t)}function o(e,t,n){e.classList[n?"add":"remove"](t)}function i(e,t,n){n=""+n,e["_s_"+t]!==n&&(e.style.setProperty(t,n),e["_s_"+t]=n)}let s=0;function l(e,t){t&&(i(e,"transition","none"),t()),s||(s=e.clientTop&&0),t&&i(e,"transition","")}function c(e,t){e.firstChild.nodeValue=t}function r(e,t){return(t||document).getElementsByClassName(e)}function a(e,t,n,o){u(!0,e,t,n,o)}function u(e,t,n,o,i){t[(e?"add":"remove")+"EventListener"](n,o,!i&&!1!==i||i)}function f(e,t){e.stopPropagation(),t&&e.preventDefault()}function d(e){return document.createElement(e)}function p(e,t){i(e,"display",t?"":"none")}function m(e,t){i(e,"visibility",t?"":"hidden")}function h(e,t){i(e,"transition",t?"":"none")}const v=["theme","download","play","page","close","autofit","zoom-in","zoom-out","prev","next","fullscreen"],g={page:1,close:1,autofit:1,"zoom-in":1,"zoom-out":1,prev:1,next:1,fullscreen:1},y={BACKSPACE:8,ESCAPE:27,SPACEBAR:32,LEFT:37,RIGHT:39,UP:38,NUMBLOCK_PLUS:107,PLUS:187,DOWN:40,NUMBLOCK_MINUS:109,MINUS:189},b=d("div");b.id="spotlight",b.innerHTML="<div class=spl-spinner></div><div class=spl-track><div class=spl-scene><div class=spl-pane></div></div></div><div class=spl-header><div class=spl-page> </div></div><div class=spl-progress></div><div class=spl-footer><div class=spl-title> </div><div class=spl-description> </div><div class=spl-button> </div></div><div class=spl-prev></div><div class=spl-next></div>";const C={},w=d("video");function k(e,t,n,o){let i,s;if("node"!==o){const e=Object.keys(n);for(let l,c=0;c<e.length;c++)if((l=e[c]).length>3&&0===l.indexOf("src"))if("video"===o){const e=C[l];if(e){if(e>0){i=n[l];break}}else{if(w.canPlayType("video/"+l.substring(3).replace("-","").toLowerCase())){C[l]=1,i=n[l];break}C[l]=-1}}else{const e=parseInt(l.substring(4),10);if(e){const o=Math.abs(t-e);(!s||o<s)&&(s=o,i=n[l])}}}return i||n.src||n.href||e.src||e.href}const x={},z=navigator.connection,E=window.devicePixelRatio||1;let S,P,T,N,_,L,U,M,O,A,R,B,F,H,q,I,K,j,D,W,X,Y,G,V,J,Q,Z,$,ee,te,ne,oe,ie,se,le,ce,re,ae,ue,fe,de,pe,me,he,ve,ge,ye,be,Ce,we,ke,xe,ze,Ee,Se,Pe,Te,Ne,_e,Le,Ue,Me,Oe=d("img");function Ae(){if(ue)return;ue=document.body,me=t("scene"),he=t("header"),ve=t("footer"),ge=t("title"),ye=t("description"),be=t("button"),Ce=t("prev"),we=t("next"),xe=t("page"),Ee=t("progress"),Se=t("spinner"),de=[t("pane")],Re("close",vt),ue[Ue="requestFullscreen"]||ue[Ue="msRequestFullscreen"]||ue[Ue="webkitRequestFullscreen"]||ue[Ue="mozRequestFullscreen"]||(Ue=""),Ue?(Me=Ue.replace("request","exit").replace("mozRequest","mozCancel").replace("Request","Exit"),ke=Re("fullscreen",rt)):v.pop(),Re("autofit",ut),Re("zoom-in",ft),Re("zoom-out",dt),Re("theme",at),ze=Re("play",tt),Re("download",ht),a(Ce,"click",yt),a(we,"click",bt);const e=t("track");function t(e){return x[e]=r("spl-"+e,b)[0]}a(e,"mousedown",st),a(e,"mousemove",ct),a(e,"mouseleave",lt),a(e,"mouseup",lt),a(e,"touchstart",st,{passive:!1}),a(e,"touchmove",ct,{passive:!0}),a(e,"touchend",lt),a(be,"click",function(){oe?oe(q,j):ne&&(location.href=ne)})}function Re(e,t){const n=d("div");return n.className="spl-"+e,a(n,"click",t),he.appendChild(n),x[e]=n}function Be(e){const t=x[e];t&&(he.removeChild(t),x[e]=null)}function Fe(e,t,n){K=e,t&&(W=t,G=t.onshow,V=t.onchange,J=t.onclose,n=n||t.index),He(n)}function He(e){if(I=K.length){ue||Ae(),G&&G(e);const n=de[0],o=n.parentNode;for(let e=de.length;e<I;e++){const t=n.cloneNode(!1);i(t,"left",100*e+"%"),o.appendChild(t),de[e]=t}fe||(ue.appendChild(b),Xe()),q=e||1,h(me),kt(!0),Ue&&We(),history.pushState({spl:1},""),history.pushState({spl:2},""),h(b,!0),t(ue,"hide-scrollbars"),t(b,"show"),Qe(!0),Xe(),ot(),$&&tt(!0,!0)}}function qe(e,t){let n=j[e];return void 0!==n?"false"!==(n=""+n)&&(n||t):t}function Ie(e){e?l(pe,Ie):(h(me,re),i(pe,"opacity",ce?0:1),Ge(le&&.8),ae&&t(pe,ae))}function Ke(e,t){e&&o(Se,"spin",t)}function je(){return document.fullscreen||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement}function De(){if(Xe(),pe&&Ye(),Ue){const e=je();o(ke,"on",e),e||We()}}function We(){p(ke,screen.availHeight-window.innerHeight>0)}function Xe(){_=b.clientWidth,L=b.clientHeight}function Ye(){U=pe.clientWidth,M=pe.clientHeight}function Ge(e){i(pe,"transform","translate(-50%, -50%) scale("+(e||O)+")")}function Ve(e,t){i(fe,"transform",e||t?"translate("+e+"px, "+t+"px)":"")}function Je(e,t,n){t?l(me,function(){Je(e,!1,n)}):i(me,"transform","translateX("+(100*-e+(n||0))+"%)")}function Qe(e){u(e,window,"keydown",$e),u(e,window,"wheel",et),u(e,window,"resize",De),u(e,window,"popstate",Ze)}function Ze(e){fe&&e.state.spl&&vt(!0)}function $e(e){if(fe){const t=!1!==j["zoom-in"];switch(e.keyCode){case y.BACKSPACE:t&&ut();break;case y.ESCAPE:vt();break;case y.SPACEBAR:$&&tt();break;case y.LEFT:yt();break;case y.RIGHT:bt();break;case y.UP:case y.NUMBLOCK_PLUS:case y.PLUS:t&&ft();break;case y.DOWN:case y.NUMBLOCK_MINUS:case y.MINUS:t&&dt()}}}function et(e){if(fe&&!1!==j["zoom-in"]){let t=e.deltaY;(t=.5*(t<0?1:t?-1:0))<0?dt():ft()}}function tt(e,t){("boolean"==typeof e?e:!Ne)===!Ne&&(Ne=Ne?clearTimeout(Ne):1,o(ze,"on",Ne),t||nt(Ne))}function nt(e){Y&&(l(Ee,function(){i(Ee,"transition-duration",""),i(Ee,"transform","")}),e&&(i(Ee,"transition-duration",se+"s"),i(Ee,"transform","translateX(0)"))),e&&(Ne=setTimeout(bt,1e3*se))}function ot(){Z&&(Le=Date.now()+2950,_e||(t(b,"menu"),function e(t){_e=setTimeout(function(){const t=Date.now();t>=Le?(n(b,"menu"),_e=0):e(Le-t)},t)}(3e3)))}function it(e){"boolean"==typeof e&&(_e=e?_e:0),_e?(_e=clearTimeout(_e),n(b,"menu")):ot()}function st(e){f(e,!0),A=!0,R=!1;let t=e.touches;t&&(t=t[0])&&(e=t),B=U*O<=_,T=e.pageX,N=e.pageY,h(fe)}function lt(e){if(f(e),A){if(R){if(B&&R){const e=S<-_/7&&(q<I||X),t=e||S>_/7&&(q>1||X);(e||t)&&(Je(q-1,!0,S/_*100),e&&bt()||t&&yt()),S=0,Ve()}h(fe,!0)}else it();A=!1}}function ct(e){if(f(e),A){let t=e.touches;t&&(t=t[0])&&(e=t);let n=(U*O-_)/2;S-=T-(T=e.pageX),B||(S>n?S=n:S<-n&&(S=-n),M*O>L&&(n=(M*O-L)/2,(P-=N-(N=e.pageY))>n?P=n:P<-n&&(P=-n))),R=!0,Ve(S,P)}else ot()}function rt(e){const t=je();"boolean"==typeof e&&e===!!t||(t?document[Me]():b[Ue]())}function at(e){"string"!=typeof e&&(e=H?"":ee||"white"),H!==e&&(H&&n(b,H),e&&t(b,e),H=e)}function ut(e){"boolean"==typeof e&&(F=!e),o(pe,"autofit",F=1===O&&!F),i(pe,"transform",""),O=1,S=0,P=0,Ye(),h(fe),Ve()}function ft(e){let t=O/.65;t<=50&&(mt(),Ve(S/=.65,P/=.65),pt(t))}function dt(e){let t=.65*O;mt(),t>=1&&(1===t?S=P=0:(S*=.65,P*=.65),Ve(S,P),pt(t))}function pt(e){O=e||1,Ge()}function mt(){F&&ut()}function ht(){!function(e,t){const n=d("a"),o=t.src;n.href=o,n.download=o.substring(o.lastIndexOf("/")+1),e.appendChild(n),n.click(),e.removeChild(n)}(ue,pe)}function vt(e){setTimeout(function(){ue.removeChild(b),fe=pe=Pe=j=W=K=G=V=J=oe=null},200),n(ue,"hide-scrollbars"),n(b,"show"),rt(!1),Qe(),history.go(!0===e?-1:-2),Te&&(Oe.src=""),Ne&&tt(),pe&&gt(pe),_e&&(_e=clearTimeout(_e)),H&&at(),ie&&n(b,ie),J&&J()}function gt(e){if(e._root)e._root.appendChild(e),e._root=null;else{const t=e.parentNode;t&&t.removeChild(e),e=e.src=e.onerror=""}}function yt(e){if(e&&ot(),I>1){if(q>1)return Ct(q-1);if(X)return Je(I,!0),Ct(I)}}function bt(e){if(e&&ot(),I>1){if(q<I)return Ct(q+1);if(X)return Je(-1,!0),Ct(1);Ne&&tt()}}function Ct(e){if(e!==q){Ne?(clearTimeout(Ne),nt()):ot();const t=e>q;return q=e,kt(t),!0}}function wt(e){let n=K[q-1];!function(e){j={},W&&Object.assign(j,W),Object.assign(j,e.dataset||e),D=j.media,oe=j.onclick,ee=j.theme,ie=j.class,Z=qe("autohide",!0),X=qe("infinite"),Y=qe("progress",!0),$=qe("autoslide"),te=qe("preload",!0),ne=j.buttonHref,se=$&&parseFloat($)||7,H||ee&&at(ee),ie&&t(b,ie),ie&&l(b);const n=j.control;if(n){const e="string"==typeof n?n.split(","):n;for(let e=0;e<v.length;e++)j[v[e]]=!1;for(let t=0;t<e.length;t++){const n=e[t].trim();"zoom"===n?j["zoom-in"]=j["zoom-out"]=!0:j[n]=!0}}const o=j.animation;if(le=ce=re=!o,ae=!1,o){const e="string"==typeof o?o.split(","):o;for(let t=0;t<e.length;t++){const n=e[t].trim();"scale"===n?le=!0:"fade"===n?ce=!0:"slide"===n?re=!0:n&&(ae=n)}}Q=j.fit}(n);const o=z&&z.downlink;let i,s=Math.max(L,_)*E;if(o&&1200*o<s&&(s=1200*o),Pe={media:D,src:k(n,s,j,D),title:qe("title",n.alt||n.title||(i=n.firstElementChild)&&(i.alt||i.title))},Te&&(Oe.src=Te=""),te&&e&&(n=K[q])){const e=n.dataset||n,t=e.media;t&&"image"!==t||(Te=k(n,s,e,t))}for(let e=0;e<v.length;e++){const t=v[e];p(x[t],qe(t,g[t]))}}function kt(e){if(S=0,P=0,O=1,pe)if(pe.onerror)gt(pe);else{let e=pe;setTimeout(function(){e&&pe!==e&&(gt(e),e=null)},650),Ie(),Ve()}wt(e),Je(q-1),n(Se,"error"),function e(o){if(fe=de[o-1],pe=fe.firstChild,q=o,pe)mt(),Q&&t(pe,Q),Ie(!0),ae&&n(pe,ae),ce&&i(pe,"opacity",1),le&&i(pe,"transform",""),i(pe,"visibility","visible"),Te&&(Oe.src=Te),$&&nt(Ne);else{const n=Pe.media,s=qe("spinner",!0);if("video"===n)Ke(s,!0),(pe=d("video")).onloadedmetadata=function(){pe===this&&(pe.onerror=null,pe.width=pe.videoWidth,pe.height=pe.videoHeight,Ye(),Ke(s),e(o))},pe.poster=j.poster,pe.preload=te?"auto":"metadata",pe.controls=qe("controls",!0),pe.autoplay=j.autoplay,pe.playsinline=qe("inline"),pe.muted=qe("muted"),pe.src=Pe.src,fe.appendChild(pe);else{if("node"===n)return"string"==typeof(pe=Pe.src)&&(pe=document.querySelector(pe)),void(pe&&(pe._root||(pe._root=pe.parentNode),Ye(),fe.appendChild(pe),e(o)));Ke(s,!0),(pe=d("img")).onload=function(){pe===this&&(pe.onerror=null,Ke(s),e(o),Ye())},pe.src=Pe.src,fe.appendChild(pe)}pe&&(s||i(pe,"visibility","visible"),pe.onerror=function(){pe===this&&(gt(pe),t(Se,"error"),Ke(s))})}}(q),h(fe),Ve();const o=Pe.title,s=qe("description"),l=qe("button"),r=o||s||l;r&&(o&&c(ge,o),s&&c(ye,s),l&&c(be,l),p(ge,o),p(ye,s),p(be,l),i(ve,"transform","all"===Z?"":"none")),Z||t(b,"menu"),m(ve,r),m(Ce,X||q>1),m(we,X||q<I),c(xe,I>1?q+" / "+I:""),V&&V(q,j)}a(document,"click",function(e){const t=e.target.closest(".spotlight");if(t){f(e,!0);const n=t.closest(".spotlight-group");K=r("spotlight",n);for(let e=0;e<K.length;e++)if(K[e]===t){W=n&&n.dataset,He(e+1);break}}});var xt={init:Ae,theme:at,fullscreen:rt,download:ht,autofit:ut,next:bt,prev:yt,goto:Ct,close:vt,zoom:pt,menu:it,show:Fe,play:tt,addControl:Re,removeControl:Be};e.addControl=Re,e.autofit=ut,e.close=vt,e.default=xt,e.download=ht,e.fullscreen=rt,e.goto=Ct,e.init=Ae,e.menu=it,e.next=bt,e.play=tt,e.prev=yt,e.removeControl=Be,e.show=Fe,e.theme=at,e.zoom=pt,Object.defineProperty(e,"__esModule",{value:!0})});